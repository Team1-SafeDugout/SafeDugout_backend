<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="guide">
	<!-- 입문 가이드 목록 조회 -->
	<select id="selectList" resultType="GuidePostDTO">
		<![CDATA[ 
		SELECT * FROM (
   	 	SELECT ROWNUM AS rnum, subquery.*
   	 	FROM (
        SELECT P.NOTICE_POST_NUMBER,
               P.NOTICE_POST_TITLE,
               P.NOTICE_POST_CONTENT,
               P.NOTICE_POST_DATE
        FROM TBL_NOTICE_POST P
        WHERE P.NOTICE_TYPE_ID = 3
        ORDER BY P.NOTICE_POST_DATE DESC
   	 	) subquery
	)WHERE rnum BETWEEN #{startRow} AND #{endRow}	
	]]>
	</select>

	<!-- 가이드 상세조회 -->
	<select id="selectDetail" parameterType="int" resultType="GuidePostDTO">
	    SELECT 
	        NP.NOTICE_POST_NUMBER,
	        NP.NOTICE_TYPE_ID,
	        NP.ADMIN_NUMBER,
	        NP.TEAM_NUMBER,
	        NP.NOTICE_POST_TITLE,
	        NP.NOTICE_POST_DATE,
	        NP.NOTICE_POST_UPDATE,
	        NP.NOTICE_POST_CONTENT,
	        AT.ATTACHMENT_NUMBER,
	        AT.ATTACHMENT_PATH,
	        AT.ATTACHMENT_NAME
	    FROM TBL_NOTICE_POST NP
	    LEFT JOIN TBL_ATTACHMENT AT
	        ON NP.NOTICE_POST_NUMBER = AT.NOTICE_POST_NUMBER
	    WHERE NP.NOTICE_POST_NUMBER = #{noticePostNumber}
	</select>


	<!-- 입문 가이드 총 갯수 조회 -->
	<select id="getTotal" resultType="int">
	    SELECT COUNT(*)
	    FROM TBL_NOTICE_POST
	    WHERE NOTICE_TYPE_ID = 3
	</select>
	
	<!-- 메인페이지 조회 -->
	<select id="selectLatestPosts" parameterType="int" resultType="GuidePostDTO">
	    SELECT *
	    FROM TBL_GUIDE_POST
	    ORDER BY NOTICE_POST_DATE DESC
	    FETCH FIRST #{count} ROWS ONLY
	</select>
	
</mapper>