<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="adminTeamPost">
	<!-- 팀 게시글 목록 조회 -->
	<select id="listSelect" resultType="AdminUserPostDTO" parameterType = "map">
	<![CDATA[
	SELECT *
	FROM (
	    SELECT ROWNUM AS rnum, subquery.*
	    FROM (
	        SELECT P.POST_NUMBER,
	               P.POST_TITLE,
	               P.POST_CONTENT,
	               P.POST_DATE,
	               P.POST_UPDATE,
	               M.MEMBER_ID,
	               M.MEMBER_NUMBER,
	               P.BOARD_ID,
	               P.TEAM_NUMBER,
	               TA.ATTACHMENT_PATH
	        FROM TBL_POST P
	        JOIN TBL_MEMBER M ON P.MEMBER_NUMBER = M.MEMBER_NUMBER
	        LEFT JOIN TBL_ATTACHMENT TA ON P.POST_NUMBER = TA.POST_NUMBER
	        WHERE P.BOARD_ID = 2
	        ORDER BY P.POST_DATE DESC
	    ) subquery
	)
	WHERE rnum BETWEEN #{startRow} AND #{endRow}
	]]>
	</select>
	
	<!-- 팀 게시글 전체수 -->
	<select id="total" resultType="int">
		SELECT COUNT(P.POST_NUMBER)
		FROM TBL_POST P
		JOIN TBL_MEMBER M ON P.MEMBER_NUMBER = M.MEMBER_NUMBER
		LEFT JOIN TBL_ATTACHMENT TA ON P.POST_NUMBER = TA.POST_NUMBER
		WHERE P.BOARD_ID = 2
	</select>
	
	<!-- 팀 게시글 상세조회 -->

	
	<!-- 팀 게시글 삭제 -->
	<delete id="delete" parameterType="int">
		DELETE 
		FROM TBL_POST
		WHERE POST_NUMBER = #{postNumber}
  		AND TEAM_NUMBER = #{teamNumber}
  		AND BOARD_ID = #{boardId}
	</delete>
</mapper>